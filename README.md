# project_308026459_300079985
Deep Learning Course 0510725501 Final Project

This repository includes our implementation of the paper "Brain tumor segmentation with Deep Neural Networks" by Mohammad Havaei et al. 
Because of medical confidentiality, we could not include in this repository any of the brains in the BraTS dataset that we used to train and test our models. The dataset can be obtained using a license from the official MICCAI site.

The repository contains the following Folders:
* MODELS - contains the best weights of each of our models. Will be used to save the models that are generated during training (a model will be saved each time the average Dice score over the tumor classes would improve).
* CODE - Contains all of our written code.
* TRAIN - Folder that contains the brains used for training. Place the BraTS 2013 patient folders (from the BraTS 2019 dataset) under this  folder.
* VALIDATION - Folder that contains the brains used for validation. Place random brains from the BraTS 2019 dataset under this folder (ones that do not belong to patients from the BraTS 2013 dataset).
* LOGS - Contains an image of each architecture as it was generated by keras. Will be used for saving logs during training.
* MISC - Contains the original paper as well as our report and presentation.

Follow these steps to run our code:
* Open the Train.py file
* Optionally change the hyperparameters at the top of the file. More information about each hyperparameter in the comments.
* Run the code.

The following files are contained in the CODE directory:
* Train.py - Responsible for the training of the model and acts as the main file for execution
* Utils.py - Contains all the utility functions that we used in our project.
* Models.py - Contains the Three-Pathway and Two-Pathway architectures along with all the cascaded architectures.
* ResNet_Model.py - Contains the architecture of the custom Resnet block that was used in the cascaded Resnet architecture
* DenseNet_Model.py - Contains the architecture of the custom Densenet block that was used in the cascaded Resnet architecture
* Print_Segmentation_Results.py - Prints the segmentation of a selected brain. For each slice generates an image containing the 4 modalities along with groud truth and prediction mask.
* calc_metrics.py - Caculates different evaluation metrics for two given sets of ground truth and prediction data over validation brains.
n4_normalization.py - Runs N4 bias field correction algorithm over the entire dataset. Must be executed in Linux environment.

We used the following github directory for inspiration in the first stages of the project:
https://github.com/naldeborgh7575/brain_segmentation
